

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>16. Customizing LASIF &mdash; LASIF 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="LASIF 0.0.1 documentation" href="../index.html"/>
        <link rel="up" title="Tutorial" href="../tutorial.html"/>
        <link rel="next" title="Command Line Interface" href="../cli.html"/>
        <link rel="prev" title="15. Next Iterations" href="14_next_iterations.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> LASIF
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../prerequisites.html">Installation, Testing &amp; DevInfo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../prerequisites.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../prerequisites.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../prerequisites.html#installing-lasif">Installing LASIF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../prerequisites.html#testing">Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../prerequisites.html#running-the-tests">Running the Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../prerequisites.html#building-the-documentation">Building the Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prerequisites.html#developer-information">Developer Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../prerequisites.html#terminology">Terminology</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#further-information">Further Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#to-do-things-that-are-still-missing">TO DO: Things that are still missing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#supported-data-formats">Supported Data Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#further-notes">Further Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#quakeml-files">QuakeML files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#synthetic-data-files">Synthetic Data Files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_interfaces.html">1. Interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="00_interfaces.html#command-line-interface">1.1. Command Line Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="00_interfaces.html#web-interface">1.2. Web Interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="01_creating_a_new_project.html">2. Creating a New Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="01_creating_a_new_project.html#configuration-file">2.1. Configuration File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="02_seismic_events.html">3. Seismic Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_station_data.html">4. Station Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="03_station_data.html#naming-scheme">4.1. Naming scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_station_data.html#stations-for-tutorial">4.2. Stations for Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="04_waveform_data.html">5. Waveform Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="04_waveform_data.html#tutorial-data">5.1. Tutorial Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="05_download_helpers.html">6. Download Helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="05_download_helpers.html#downloading-waveforms">6.1. Downloading Waveforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_download_helpers.html#downloading-station-metadata">6.2. Downloading Station Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="06_data_inspection.html">7. Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_data_validation.html">8. Data Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_a_new_iteration.html">9. Defining a New Iteration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="08_a_new_iteration.html#the-iteration-xml-files">9.1. The Iteration XML Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_a_new_iteration.html#source-time-functions">9.2. Source Time Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_a_new_iteration.html#attenuation">9.3. Attenuation</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_a_new_iteration.html#data-preprocessing">9.4. Data Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_a_new_iteration.html#data-rejection">9.5. Data Rejection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="09_model_handling.html">10. Earth Model Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_generating_input_files.html">11. Generating SES3D Input Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="10_generating_input_files.html#input-file-generation">11.1. Input File Generation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="11_synthetic_waveforms.html">12. Synthetics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="11_synthetic_waveforms.html#recap">12.1. Recap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="12_misfits_and_adjoint_sources.html">13. Misfit and Adjoint Source Calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="12_misfits_and_adjoint_sources.html#weighting-scheme">13.1. Weighting Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="12_misfits_and_adjoint_sources.html#misfit-gui">13.2. Misfit GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="12_misfits_and_adjoint_sources.html#final-adjoint-source-calculation">13.3. Final Adjoint Source Calculation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="13_model_update.html">14. Model Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_next_iterations.html">15. Next Iterations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="14_next_iterations.html#create-a-new-iteration-from-scratch">15.1. Create a new iteration from scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="14_next_iterations.html#deriving-from-an-existing-iteration">15.2. Deriving from an existing iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="14_next_iterations.html#migrating-the-misfit-windows">15.3. Migrating the misfit windows</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">16. Customizing LASIF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#common-features-of-the-custom-functions">16.1. Common Features of the Custom Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-preprocessing">16.2. Custom Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-synthetic-data-processing">16.3. Custom Synthetic Data Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customize-window-picking">16.4. Customize Window Picking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customize-the-source-time-function">16.5. Customize the Source Time Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli.html#mpi">MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli.html#command-documentation">Command Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cli.html#data-acquisition-functions">Data Acquisition Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-download-data">lasif download_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-add-gcmt-events">lasif add_gcmt_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-add-spud-event">lasif add_spud_event</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cli.html#event-management-functions">Event Management Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-event-info">lasif event_info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-list-events">lasif list_events</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cli.html#iteration-management-functions">Iteration Management Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-select-windows">lasif select_windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-generate-input-files">lasif generate_input_files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-calculate-all-adjoint-sources">lasif calculate_all_adjoint_sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-finalize-adjoint-sources">lasif finalize_adjoint_sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-iteration-status">lasif iteration_status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-create-successive-iteration">lasif create_successive_iteration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-compare-misfits">lasif compare_misfits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-preprocess-data">lasif preprocess_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-list-iterations">lasif list_iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-create-new-iteration">lasif create_new_iteration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-migrate-windows">lasif migrate_windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-q-model">lasif plot_q_model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-iteration-info">lasif iteration_info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-launch-misfit-gui">lasif launch_misfit_gui</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cli.html#misc-functions">Misc Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-debug">lasif debug</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-shell">lasif shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-serve">lasif serve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-tutorial">lasif tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-calculate-constant-q-model">lasif calculate_constant_q_model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cli.html#plotting-functions">Plotting Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-events">lasif plot_events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-event">lasif plot_event</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-wavefield">lasif plot_wavefield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-raydensity">lasif plot_raydensity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-launch-model-gui">lasif launch_model_gui</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-windows">lasif plot_windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-stf">lasif plot_stf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-plot-domain">lasif plot_domain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cli.html#project-management-functions">Project Management Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-info">lasif info</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-list-kernels">lasif list_kernels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-validate-data">lasif validate_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-init-project">lasif init_project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-list-models">lasif list_models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-remove-empty-coordinate-entries">lasif remove_empty_coordinate_entries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cli.html#lasif-build-all-caches">lasif build_all_caches</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webinterface.html">Web Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../iris2quakeml.html">lasif.scripts.iris2quakeml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ses3d_setup_helper.html">SES3D Setup Assistant</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ses3d_setup_helper.html#module-lasif.scripts.ses3d_setup_helper">Internal Function Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../iteration_xml.html">lasif.iteration_xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rotations.html">lasif.rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../window_selection.html">lasif.window_selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools.html">lasif.tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools.parallel.html">lasif.tools.parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools.file_info_cache.html">lasif.tools.file_info_cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../components/components.html">API Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/events.html">EventsComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/inventory_db.html">InventoryDBComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/iterations.html">IterationsComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/stations.html">StationsComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/waveforms.html">WaveformsComponent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/query.html">QueryComponent</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../how_lasif_finds_coordinates.html">How LASIF Finds Coordinates</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">LASIF</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
      
    <li>16. Customizing LASIF</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorial/15_customizing_lasif.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="customizing-lasif">
<h1>16. Customizing LASIF<a class="headerlink" href="#customizing-lasif" title="Permalink to this headline">¶</a></h1>
<p>Sometimes the built-in configuration possibilities of LASIF just don&#8217;t cut
it and you need to change things in a more profound way. To this end LASIF
offers per-project functions that will be called by LASIF on different
occasions.</p>
<p><strong>If you still feel the need to modify LASIF directly, please contact the
developers.</strong> LASIF aims to be a common tool for full waveform inversions
and if everyone has a custom LASIF version that is not possible. If
necessary we will make it more flexible.</p>
<p>In any case, the per-project functions are stored in the <code class="docutils literal"><span class="pre">FUNCTION</span></code>
subfolder of an active LASIF project. If you ever want to update these
function to the latest official version of LASIF just delete the files and
launch any LASIF command.</p>
<div class="highlight-none"><div class="highlight"><pre>FUNCTIONS
├── preprocessing_function.py
├── process_synthetics.py
└── window_picking_function.py
</pre></div>
</div>
<div class="section" id="common-features-of-the-custom-functions">
<h2>16.1. Common Features of the Custom Functions<a class="headerlink" href="#common-features-of-the-custom-functions" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">LASIF does not keep track of which function has been called for which
iteration. This is a choice to make customizing it reasonably easy but it
does hurt reproducibility and provenance. It is your responsibility to
store the used functions and make a copy if necessary.
A simple way to keep track of the differences in these function is to
branch based on the current iteration.</p>
</div>
<p>All of the custom function are passed an
<a class="reference internal" href="../iteration_xml.html#lasif.iteration_xml.Iteration" title="lasif.iteration_xml.Iteration"><code class="xref py py-class docutils literal"><span class="pre">Iteration</span></code></a> object, thus code like the following
is the preferred way to handle differences in these function per iterations.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">custom_function</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">iteration</span><span class="p">):</span>
    <span class="c"># Assumes iteration names are numeric. You might need a more</span>
    <span class="c"># complicated setup depending on your project.</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">iteration</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">do_this</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">do_that</span><span class="p">()</span>
</pre></div>
</div>
<p>To figure out what these iteration objects can do, launch an interactive lasif
session and play around a bit.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>lasif shell
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">iteration</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">iterations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">iteration</span><span class="o">.</span><span class="n">name</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="s">&#39;1&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">iteration</span><span class="o">.</span><span class="n">get_process_params</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
 <span class="s">&#39;highpass&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
 <span class="s">&#39;lowpass&#39;</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span>
 <span class="s">&#39;npts&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
 <span class="s">&#39;stf&#39;</span><span class="p">:</span> <span class="s">&#39;Filtered Heaviside&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-preprocessing">
<h2>16.2. Custom Preprocessing<a class="headerlink" href="#custom-preprocessing" title="Permalink to this headline">¶</a></h2>
<p>The preprocessing function is used to preprocess all the data. It has the
following function signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">preprocessing_function</span><span class="p">(</span><span class="n">processing_info</span><span class="p">,</span> <span class="n">iteration</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>It is supposed to read the <code class="docutils literal"><span class="pre">procesing_info[&quot;input_filename&quot;]</span></code> file, apply
the defined processing, and write it to <code class="docutils literal"><span class="pre">processing_info[&quot;output_filename&quot;]</span></code>.
It does not have to return anything; raise an error if something does not
work as expected.</p>
<p>The <code class="docutils literal"><span class="pre">processing_info</span></code> object also contains event and station information.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;event_information&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&#39;depth_in_km&#39;</span><span class="p">:</span> <span class="mf">22.0</span><span class="p">,</span>
    <span class="s">&#39;event_name&#39;</span><span class="p">:</span> <span class="s">&#39;GCMT_event_VANCOUVER_ISLAND...&#39;</span><span class="p">,</span>
    <span class="s">&#39;filename&#39;</span><span class="p">:</span> <span class="s">&#39;/.../GCMT_event_VANCOUVER_ISLAND....xml&#39;</span><span class="p">,</span>
    <span class="s">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">49.53</span><span class="p">,</span>
    <span class="s">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">126.89</span><span class="p">,</span>
    <span class="s">&#39;m_pp&#39;</span><span class="p">:</span> <span class="mf">2.22e+18</span><span class="p">,</span>
    <span class="s">&#39;m_rp&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.78e+18</span><span class="p">,</span>
    <span class="s">&#39;m_rr&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.15e+17</span><span class="p">,</span>
    <span class="s">&#39;m_rt&#39;</span><span class="p">:</span> <span class="mf">1.98e+17</span><span class="p">,</span>
    <span class="s">&#39;m_tp&#39;</span><span class="p">:</span> <span class="mf">5.14e+18</span><span class="p">,</span>
    <span class="s">&#39;m_tt&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.61e+18</span><span class="p">,</span>
    <span class="s">&#39;magnitude&#39;</span><span class="p">:</span> <span class="mf">6.5</span><span class="p">,</span>
    <span class="s">&#39;magnitude_type&#39;</span><span class="p">:</span> <span class="s">&#39;Mwc&#39;</span><span class="p">,</span>
    <span class="s">&#39;origin_time&#39;</span><span class="p">:</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">200000</span><span class="p">),</span>
    <span class="s">&#39;region&#39;</span><span class="p">:</span> <span class="s">u&#39;VANCOUVER ISLAND, CANADA REGION&#39;</span><span class="p">},</span>
 <span class="s">&#39;input_filename&#39;</span><span class="p">:</span> <span class="s">u&#39;/.../raw/7D.FN01A..HHZ.mseed&#39;</span><span class="p">,</span>
 <span class="s">&#39;output_filename&#39;</span><span class="p">:</span> <span class="s">u&#39;/.../processed_.../7D.FN01A..HHZ.mseed&#39;</span><span class="p">,</span>
 <span class="s">&#39;process_params&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
    <span class="s">&#39;highpass&#39;</span><span class="p">:</span> <span class="mf">0.007142857142857143</span><span class="p">,</span>
    <span class="s">&#39;lowpass&#39;</span><span class="p">:</span> <span class="mf">0.0125</span><span class="p">,</span>
    <span class="s">&#39;npts&#39;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="s">&#39;stf&#39;</span><span class="p">:</span> <span class="s">&#39;Filtered Heaviside&#39;</span><span class="p">},</span>
 <span class="s">&#39;station_coordinates&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&#39;elevation_in_m&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">54.0</span><span class="p">,</span>
    <span class="s">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">46.882</span><span class="p">,</span>
    <span class="s">&#39;local_depth_in_m&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
    <span class="s">&#39;longitude&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">124.3337</span><span class="p">},</span>
 <span class="s">&#39;station_filename&#39;</span><span class="p">:</span> <span class="s">u&#39;/.../STATIONS/RESP/RESP.7D.FN01A..HH*&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-synthetic-data-processing">
<h2>16.3. Custom Synthetic Data Processing<a class="headerlink" href="#custom-synthetic-data-processing" title="Permalink to this headline">¶</a></h2>
<p>LASIF, by default, does not apply any processing (except rotations and
component flips to get them to ZNE) to the synthetics but just
uses them as is. If your workflow requires the synthetics to be processed,
please do it in this function. It will be applied on the fly to each
up-to-three component <a class="reference external" href="http://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.html#obspy.core.stream.Stream" title="(in ObsPy Documentation (0.10.2) v0.10)"><code class="xref py py-class docutils literal"><span class="pre">Stream</span></code></a> object of synthetic
data.</p>
<p>The default implementation is this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">process_synthetics</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">iteration</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">st</span>
</pre></div>
</div>
<p>This is very useful for processing the synthetics in any fashion or to shift
them time and similar endeavours. Make sure it returns a
<a class="reference external" href="http://docs.obspy.org/packages/autogen/obspy.core.stream.Stream.html#obspy.core.stream.Stream" title="(in ObsPy Documentation (0.10.2) v0.10)"><code class="xref py py-class docutils literal"><span class="pre">Stream</span></code></a> object.</p>
</div>
<div class="section" id="customize-window-picking">
<h2>16.4. Customize Window Picking<a class="headerlink" href="#customize-window-picking" title="Permalink to this headline">¶</a></h2>
<p>Use this function to customize the window picking of LASIF, or even use a
completely different window picking algorithm. Its function signature is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">window_picking_function</span><span class="p">(</span><span class="n">data_trace</span><span class="p">,</span> <span class="n">synthetic_trace</span><span class="p">,</span> <span class="n">event_latitude</span><span class="p">,</span>
                            <span class="n">event_longitude</span><span class="p">,</span> <span class="n">event_depth_in_km</span><span class="p">,</span>
                            <span class="n">station_latitude</span><span class="p">,</span> <span class="n">station_longitude</span><span class="p">,</span>
                            <span class="n">minimum_period</span><span class="p">,</span> <span class="n">maximum_period</span><span class="p">,</span>
                            <span class="n">iteration</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="c"># Make sure it return a list of tuples, each denoting start and</span>
    <span class="c"># endtime for each picked window.</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="o">...</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="o">...</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="section" id="customize-the-source-time-function">
<h2>16.5. Customize the Source Time Function<a class="headerlink" href="#customize-the-source-time-function" title="Permalink to this headline">¶</a></h2>
<p>This function is used to generate source time functions for SES3D. If you
don&#8217;t use SES3D for the numerical wavefield simulations you can ignore this.
Its function signature is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">source_time_function</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">freqmin</span><span class="p">,</span> <span class="n">freqmax</span><span class="p">,</span> <span class="n">iteration</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="c"># Make sure it returns a float64 NumPy array with `npts` samples.</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cli.html" class="btn btn-neutral float-right" title="Command Line Interface" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="14_next_iterations.html" class="btn btn-neutral" title="15. Next Iterations" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Lion Krischer &amp; Andreas Fichtner.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>