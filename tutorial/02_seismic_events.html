

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Seismic Events &mdash; LASIF 0.1.x documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Station Data" href="03_station_data.html" />
    <link rel="prev" title="2. Creating a New Project" href="01_creating_a_new_project.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> LASIF
          

          
          </a>

          
            
            
              <div class="version">
                0.1.x
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../prerequisites.html">Installation, Testing &amp; DevInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_interfaces.html">1. Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_creating_a_new_project.html">2. Creating a New Project</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Seismic Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automatic-event-selection">3.1. Automatic Event Selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="03_station_data.html">4. Station Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_download_helpers.html">5. Download Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_data_inspection.html">6. Data Inspection</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_data_validation.html">7. Data Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_a_new_iteration.html">8. Defining a New Iteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_data_processing.html">9. Data Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_model_handling.html">10. Earth Model Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_generating_input_files.html">11. Generating Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_synthetic_waveforms.html">12. Synthetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_misfits_and_adjoint_sources.html">13. Misfit and Adjoint Source Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_gradient_visualization.html">14. Gradient Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meshing.html">Meshing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webinterface.html">Web Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LASIF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
        
      <li>3. Seismic Events</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/02_seismic_events.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p class="centered">
<strong>Last updated on <em>February 22nd 2018</em>.</strong></p><div class="section" id="seismic-events">
<h1>3. Seismic Events<a class="headerlink" href="#seismic-events" title="Permalink to this headline">Â¶</a></h1>
<p>Once you have made a mesh file and referenced its location in the config file
it is time to import events to the project. <strong>LASIF</strong> expects the data to be
stored in the <em>DATA/EARTHQUAKES/</em> directory in an <a class="reference external" href="http://seismicdata.github.io/pyasdf/">ASDF Data format</a>. You can either use the pyasdf package
to organise your own data into the ASDF format or you can use the tools that
<strong>LASIF</strong> provides to query different databases for events within your domain.
<strong>LASIF</strong> expects the data to contain valid QuakeML files with full moment
tensor information. Each event is organised in one asdf file, the waveform and
station data for said event will also be included in that one file. That means
that all the raw information concerning this one event is contained in one
file. That makes bookkeeping easier and the pyasdf can be used to look into
each file.</p>
<p>LASIF provides some convenient methods for this purpose. One can make use of the
<a class="reference external" href="http://www.iris.edu/spud/momenttensor">IRIS SPUD service</a> to get GlobalCMT
events.  Simply search for an event on their webpage and copy the event url.
The <code class="docutils literal notranslate"><span class="pre">lasif</span> <span class="pre">add_spud_event</span></code> command will then grab the QuakeML file from the
url and store an asdf file in the correct folder.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ lasif add_spud_event http://ds.iris.edu/spud/momenttensor/988455
$ lasif add_spud_event http://ds.iris.edu/spud/momenttensor/735711
</pre></div>
</div>
<p>These commands will download two event files and store them in the
<code class="docutils literal notranslate"><span class="pre">EVENTS</span></code> subfolder.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ls DATA/EARTHQUAKES

GCMT_event_TURKEY_Mag_5.1_2010-3-24-14-11.h5
GCMT_event_TURKEY_Mag_5.9_2011-5-19-20-11.h5
</pre></div>
</div>
<p>A more convenient way to see which events are currently defined in the
project is the <code class="docutils literal notranslate"><span class="pre">lasif</span> <span class="pre">list_events</span></code> command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ lasif list_events

<span class="m">2</span> events in project:
+-------------------------------------------+-----------------------------+
<span class="p">|</span> Event Name                                <span class="p">|</span>    Lat/Lng/Depth<span class="o">(</span>km<span class="o">)</span>/Mag    <span class="p">|</span>
+-------------------------------------------+-----------------------------+
<span class="p">|</span> GCMT_event_TURKEY_Mag_5.1_2010-3-24-14-11 <span class="p">|</span>   <span class="m">38</span>.8 /   <span class="m">40</span>.1 /   <span class="m">4</span> / <span class="m">5</span>.1 <span class="p">|</span>
<span class="p">|</span> GCMT_event_TURKEY_Mag_5.9_2011-5-19-20-15 <span class="p">|</span>   <span class="m">39</span>.1 /   <span class="m">29</span>.1 /   <span class="m">7</span> / <span class="m">5</span>.9 <span class="p">|</span>
+----------------------------------------+--------------------------------+
</pre></div>
</div>
<p>You will notice that events are identified via their filename minus the
extension. This is an easy and flexible solution enabling you to tag the events
as you see fit. The slight disadvantage of this approach is that <strong>you must not
change the event filenames after you have worked with them</strong> because all
additional information for that event will be related to it via the event
filename. So please give them a good and reasonable filename. If you really
feel that event renaming is a necessary feature please file an issue on Github
so that the authors can add a proper event renaming function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">lasif</span> <span class="pre">plot_events</span></code> command will show a map with all events currently
part of the project. With the same command, you can get histograms of depth
distribution and origin time distribution by appending <code class="docutils literal notranslate"><span class="pre">--type</span> <span class="pre">depth</span></code> or
<code class="docutils literal notranslate"><span class="pre">--type</span> <span class="pre">time</span></code>, respectively.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ lasif plot_events
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/plot_events.png"><img alt="../_images/plot_events.png" class="align-center" src="../_images/plot_events.png" style="width: 60%;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">lasif</span> <span class="pre">event_info</span></code> command is your friend if you want more information
about a certain event:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ lasif event_info GCMT_event_TURKEY_Mag_5.1_2010-3-24-14-11

Earthquake with <span class="m">5</span>.1 Mwc at TURKEY
    Latitude: <span class="m">38</span>.690, Longitude: <span class="m">39</span>.990, Depth: <span class="m">28</span>.9 km
    <span class="m">2010</span>-03-24T14:11:34.300000Z UTC

Station and waveform information available at <span class="m">0</span> stations. Use <span class="s1">&#39;-v&#39;</span> to print them.
</pre></div>
</div>
<p>The information given with this command will be what <strong>LASIF</strong> uses. This is
useful if the event has more than one origin and you want to know which one
is actually used by <strong>LASIF</strong>. Notice that the event currently has no data associated
with it. We will fix this in the next section.</p>
<p>After adding the events, this is how your directory structure should look:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Tutorial
âââ ADJOINT_SOURCES
âââ DATA
âÂ Â  âââ CORRELATIONS
âÂ Â  âââ EARTHQUAKES
âÂ Â      âââ GCMT_event_TURKEY_Mag_5.1_2010-3-24-14-11.h5
âÂ Â      âââ GCMT_event_TURKEY_Mag_5.9_2011-5-19-20-15.h5
âââ FUNCTIONS
âÂ Â  âââ __init__.py
âÂ Â  âââ light_preprocessing.py
âÂ Â  âââ preprocessing_function_asdf.py
âÂ Â  âââ process_data.py
âÂ Â  âââ process_synthetics.py
âÂ Â  âââ source_time_function.py
âÂ Â  âââ window_picking_function.py
âââ GRADIENTS
âââ MODELS
âââ OUTPUT
âÂ Â  âââ LOGS
âââ PROCESSED_DATA
âÂ Â  âââ CORRELATIONS
âÂ Â  âââ EARTHQUAKES
âââ SALVUS_INPUT_FILES
âââ SETS
âÂ Â  âââ WEIGHTS
âÂ Â  âââ WINDOWS
âââ SYNTHETICS
âÂ Â  âââ CORRELATIONS
âÂ Â  âââ EARTHQUAKES
âââ lasif_config.toml
</pre></div>
</div>
<div class="section" id="automatic-event-selection">
<h2>3.1. Automatic Event Selection<a class="headerlink" href="#automatic-event-selection" title="Permalink to this headline">Â¶</a></h2>
<p>Selecting events becomes tedious when selecting a larger number of events. Thus
<strong>LASIF</strong> comes with an automatic routine to select events from the GCMT
catalog, the <code class="docutils literal notranslate"><span class="pre">lasif</span> <span class="pre">add_gcmt_events</span></code> command. Arguments are number of events
to select, minimum magnitude, maximum magnitude, and the minimum distance
between two events in kilometers. See its help method for more details.</p>
<p>It will select events, that fit the selected criteria and fit inside the
domain defined by the mesh file, in an optimally distributed fashion by
successively adding events that have the largest distance to the next closest
station, approximating a Poisson disc distribution.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ lasif add_gcmt_events <span class="m">40</span> <span class="m">5</span> <span class="m">6</span>.5 <span class="m">10</span>

LASIF currently contains GCMT data from <span class="m">2005</span> to <span class="m">2017</span>.
...
Selected <span class="m">40</span> events.
Written EVENTS/GCMT_event_...
...
</pre></div>
</div>
<p>These events will not be used in this tutorial but rather the events already
downloaded using the add_spud_event method. So if you ran the command above
but want to follow the tutorial step by step. We would recommend either
removing the 40 new events manually or removing all of them and running the
add_spud_event command again like is done above. You can remove all your
events by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ rm DATA/EARTHQUAKES/*
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You do not need to add all events you plan to use in the inversion at the
beginning. Only add those you want to use for the very first inversion.
<strong>LASIF</strong> is rather flexible and enables you to use different events, data,
weighting schemes, etc. for every iteration. It will keep track of what
actually happened during each iteration so the project gains
<strong>reproducibility and provenance</strong>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="03_station_data.html" class="btn btn-neutral float-right" title="4. Station Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="01_creating_a_new_project.html" class="btn btn-neutral" title="2. Creating a New Project" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Lion Krischer &amp; Andreas Fichtner.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.x',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>